RCAS 規則檔填寫指南 (rules.xlsx)
文件版本：v5.1
核心原則：只要您在 Excel 填寫了下列關鍵字，系統就會強制執行對應的功能，無視 AI 的判斷。
1. Category_Rule 欄位 (工程檢驗)
此欄位決定系統如何檢查「尺寸數值」。請填寫下列英文關鍵字：
range
 * 觸發功能：「區間公差檢查」
 * 行為：
   * 強制要求數值必須是 小數點後兩位 (例如 150.00)。
   * 數值必須落在規格書的公差範圍內 (例如 ±0.05)。
 * 適用：再生、研磨、精車。
max_limit
 * 觸發功能：「上限閾值檢查」
 * 行為：
   * 強制要求數值必須是 整數。
   * 數值 不得大於 規格中的最大值。
 * 適用：軸頸、軸頭、軸位、內孔。
min_limit
 * 觸發功能：「下限閾值檢查」
 * 行為：
   * 強制要求數值必須是 整數。
   * 數值 不得小於 規格中的最小值。
 * 適用：銲補。
un_regen
 * 觸發功能：「未再生檢查」
 * 行為：
   * 強制要求數值必須是 整數。
   * 檢查素材尺寸是否符合大致規格。
 * 適用：本體未再生。
exempt
 * 觸發功能：「完全豁免」
 * 行為：
   * 完全不檢查尺寸。
   * 直接判定為合格 (Pass)。
 * 適用：動平衡、熱處理、或是任何「不想驗尺寸」的項目。
2. Unit_Rule 欄位 (數量/會計)
此欄位包含 Unit_Rule_Local (單項)、Unit_Rule_Agg (總表)、Unit_Rule_Freight (運費)。
請填寫 「分子/分母」 格式的數字或特殊關鍵字：
1/1 (或留空)
 * 觸發功能：「原樣計數」
 * 行為：
   * 單項：抓到幾行 ID，數量就是多少 (PC)。
   * 運費/總表：依據單項數量，全額計入。
1/X (例如 1/4)
 * 觸發功能：「分組換算」
 * 行為：
   * 單項：將 ID 行數 除以 X (例如 4 支 ID 算 1 組 SET)。
   * 運費/總表：直接引用換算後的結果 (1 組)。
SKIP
 * 觸發功能：「忽略不計」
 * 行為：
   * 總表/運費：此項目完全不計入，金額或數量為 0。
參數選項：
• A (嚴格名稱模式)
• 邏輯：純粹比對「總表名稱」與「細項標題」的字串相似度。
• 條件：相似度必須 > 90% 才能配對。
• 適用情境：總表跟細項的名字寫得幾乎一模一樣，不需要靠關鍵字去猜的時候。
• B (智能特徵模式) (預設值)
• 邏輯：不看字串相似度，而是檢查「特徵」是否吻合。
• 條件：
1. 動作吻合：細項是「車修」，總表也要有「車修」（或再生/精車）。
2. 部位吻合：細項是「軸頸」，總表也要有「軸頸」。
• 適用情境：名字長得不一樣，但意思一樣（例如總表寫 "ROLL車修"，細項寫 "驅動輪軸心再生"）。
• AB (混合寬鬆模式)
• 邏輯：A 模式 OR B 模式。
• 條件：只要符合 A (相似度高) 或者 符合 B (特徵對)，就算配對成功。
• 適用情境：最頑強的項目，怕 B 模式抓漏，又怕 A 模式分數不夠高，就開 AB 讓它雙重過濾。
• SKIP (忽略模式)
• 邏輯：強制略過。
• 行為：此項目完全不計入總表。

3. Process_Rule 欄位 (工序溯源)
此欄位決定該項目是流程中的第幾站。請填寫 數字 1~4：
1
 * 觸發功能：設定為「未再生 / 粗車」
 * 行為：作為尺寸比較的最大基準值。
2
 * 觸發功能：設定為「銲補」
 * 行為：系統會檢查尺寸是否小於 Stage 1 (車掉) 或大於 Stage 3 (堆焊)。
3
 * 觸發功能：設定為「再生 / 精車」
 * 行為：系統會檢查尺寸是否大於 Stage 4 (預留研磨量)。
4
 * 觸發功能：設定為「研磨 (最終站)」
 * 行為：
   * 回頭查帳：系統會往前檢查 Stage 3 與 Stage 2 是否存在 (沒做會報錯)。
   * 尺寸把關：確認「研磨後尺寸」必須小於「再生尺寸」。
4. 系統自動觸發 (無需填寫)
下列功能由程式自動判斷，使用者不需要在 Excel 填寫，但需知悉：
批量總數模式 (Batch Total)
 * 如何觸發：標題有「熱處理」、「研磨」、「動平衡」 且 內文第一格是合併儲存格總數 (如 2425 KG)。
 * 功能：直接對帳總數字，不數行數。
運費智能配對
 * 如何觸發：總表標題像「輥輪拆裝.車修或銲補運費」。
 * 功能：即使 OCR 讀成「運貨」，也會自動歸戶。
互斥鎖 (Top/Bottom)
 * 如何觸發：總表出現 TOP 或 BOTTOM。
 * 功能：自動踢除另一邊的項目 (例如總表 TOP 會踢除細項 BOTTOM)，防止抓錯。
